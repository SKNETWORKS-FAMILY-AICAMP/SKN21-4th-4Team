# EC2 ë°°í¬ ê°€ì´ë“œ

> **ëŒ€ìƒ**: ì„œë²„ ë°°í¬ ë‹¨ê³„ë³„ ê°€ì´ë“œ  
> **ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…**: t3.medium (vCPU 2ê°œ, ë©”ëª¨ë¦¬ 4GB)

## ğŸ“‹ ëª©ì°¨

1. [ì‚¬ì „ ì¤€ë¹„](#ì‚¬ì „-ì¤€ë¹„)
2. [EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±](#ec2-ì¸ìŠ¤í„´ìŠ¤-ìƒì„±)
3. [ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •](#ë³´ì•ˆ-ê·¸ë£¹-ì„¤ì •)
4. [SSH ì ‘ì†](#ssh-ì ‘ì†)
5. [ì„œë²„ ì´ˆê¸° ì„¤ì •](#ì„œë²„-ì´ˆê¸°-ì„¤ì •)
6. [ì½”ë“œ ë°°í¬](#ì½”ë“œ-ë°°í¬)
7. [ì„œë¹„ìŠ¤ ì‹¤í–‰ í™•ì¸](#ì„œë¹„ìŠ¤-ì‹¤í–‰-í™•ì¸)
8. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ì‚¬ì „ ì¤€ë¹„

### âœ… í•„ìš”í•œ ê²ƒ

- [ ] AWS ê³„ì • (IAM ì‚¬ìš©ì ê¶Œí•œ: EC2 FullAccess)
- [ ] ë¡œì»¬ì— í”„ë¡œì íŠ¸ ì½”ë“œ ì¤€ë¹„ë¨
- [ ] `.env` íŒŒì¼ ì„¤ì • (API í‚¤ ë“±)
- [ ] SSH í´ë¼ì´ì–¸íŠ¸
  - **Windows**: PowerShell ë˜ëŠ” Git Bash
  - **Mac/Linux**: í„°ë¯¸ë„

### ğŸ“Š ì˜ˆìƒ ë¹„ìš©

| í•­ëª©          | ì‚¬ì–‘            | ì‹œê°„ë‹¹ ë¹„ìš© | ì›” ë¹„ìš© (730ì‹œê°„) |
| ------------- | --------------- | ----------- | ----------------- |
| EC2 t3.medium | 2 vCPU, 4GB RAM | ~$0.0416    | ~$30              |
| EBS ìŠ¤í† ë¦¬ì§€  | 30GB            | -           | ~$3               |
| **í•©ê³„**      |                 |             | **~$33/ì›”**       |

> [!TIP]
> í”„ë¡œì íŠ¸ ë°œí‘œ í›„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¤‘ì§€í•˜ë©´ ë¹„ìš© ì ˆì•½ ê°€ëŠ¥ (EBS ë¹„ìš©ë§Œ ë°œìƒ)

---

## EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

### Step 1: AWS EC2 ì½˜ì†” ì ‘ì†

1. [AWS ì½˜ì†”](https://console.aws.amazon.com/) ì ‘ì† ë° ë¡œê·¸ì¸
2. ê²€ìƒ‰ì°½ì— "EC2" ì…ë ¥ í›„ í´ë¦­
3. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ **"ì¸ìŠ¤í„´ìŠ¤"** í´ë¦­
4. ìš°ì¸¡ ìƒë‹¨ **"ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘"** ë²„íŠ¼ í´ë¦­

### Step 2: ì¸ìŠ¤í„´ìŠ¤ ì„¤ì •

#### 1ï¸âƒ£ ì´ë¦„ ë° íƒœê·¸
```
ì´ë¦„: skn21-django-app
```

#### 2ï¸âƒ£ ìš´ì˜ ì²´ì œ ì´ë¯¸ì§€ (AMI)
- **ì„ íƒ**: Ubuntu
- **ë²„ì „**: Ubuntu Server 24.04 LTS (HVM), SSD Volume Type
- **ì•„í‚¤í…ì²˜**: 64ë¹„íŠ¸ (x86)

> [!IMPORTANT]
> **Ubuntu 24.04 LTS**ë¥¼ ì„ íƒí•˜ì„¸ìš”. ìµœì‹  LTS ë²„ì „ìœ¼ë¡œ 2029ë…„ê¹Œì§€ ì§€ì›ë©ë‹ˆë‹¤.

#### 3ï¸âƒ£ ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•
- **ì„ íƒ**: `t3.medium`
  - vCPU: 2
  - ë©”ëª¨ë¦¬: 4 GiB
  - ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥: ìµœëŒ€ 5 Gbps

#### 4ï¸âƒ£ í‚¤ í˜ì–´ (ë¡œê·¸ì¸)

**ìƒˆ í‚¤ í˜ì–´ ìƒì„±í•˜ê¸°**:
1. "ìƒˆ í‚¤ í˜ì–´ ìƒì„±" í´ë¦­
2. ì„¤ì •:
   - **í‚¤ í˜ì–´ ì´ë¦„**: `skn21-key`
   - **í‚¤ í˜ì–´ ìœ í˜•**: RSA
   - **í”„ë¼ì´ë¹— í‚¤ íŒŒì¼ í˜•ì‹**: 
     - Windows: `.ppk` (PuTTY ì‚¬ìš© ì‹œ) ë˜ëŠ” `.pem` (PowerShell/Git Bash ì‚¬ìš© ì‹œ)
     - Mac/Linux: `.pem`
3. "í‚¤ í˜ì–´ ìƒì„±" í´ë¦­
4. **ì¤‘ìš”**: ë‹¤ìš´ë¡œë“œëœ í‚¤ íŒŒì¼ì€ ì•ˆì „í•œ ê³³ì— ë³´ê´€
   ```bash
   # Windows ì˜ˆì‹œ
   C:\Users\<ì‚¬ìš©ìëª…>\.ssh\skn21-key.pem
   
   # Mac/Linux ì˜ˆì‹œ
   ~/.ssh/skn21-key.pem
   ```

> [!CAUTION]
> í‚¤ íŒŒì¼ì„ ìƒì–´ë²„ë¦¬ë©´ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤! ë°˜ë“œì‹œ ë°±ì—…í•˜ì„¸ìš”.

#### 5ï¸âƒ£ ë„¤íŠ¸ì›Œí¬ ì„¤ì • âš ï¸ ì¤‘ìš”!

**"í¸ì§‘" ë²„íŠ¼ì„ ë°˜ë“œì‹œ í´ë¦­**í•˜ì—¬ ì•„ë˜ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”:

**VPC ë° ì„œë¸Œë„·**:
1. **VPC**: ê¸°ë³¸ VPC ì„ íƒ (ë˜ëŠ” ë³¸ì¸ì˜ VPC)
2. **ì„œë¸Œë„·**: âš ï¸ **í¼ë¸”ë¦­ ì„œë¸Œë„·** ì„ íƒ í•„ìˆ˜!
   ```
   ì˜¬ë°”ë¥¸ ì˜ˆì‹œ:
   - my-vpc-subnet-public1-ap-northeast-2a
   - subnet-xxxx (Public)
   - ap-northeast-2a (ê°€ìš©ì˜ì—­ ì´ë¦„ë§Œ ìˆëŠ” ê²½ìš°)
   
   âŒ ì˜ëª»ëœ ì˜ˆì‹œ (ì„ íƒ ê¸ˆì§€!):
   - RDS-PVT-subnet-1
   - subnet-xxxx (Private)
   - DB-subnet-2
   ```

**í¼ë¸”ë¦­ IP ìë™ í• ë‹¹**:
- **í™œì„±í™”** ì„ íƒ âœ…
- ì´ ì„¤ì •ì„ í™œì„±í™”í•˜ë©´ Elastic IP í• ë‹¹ ë¶ˆí•„ìš”

**ë³´ì•ˆ ê·¸ë£¹**:
1. **"ìƒˆ ë³´ì•ˆ ê·¸ë£¹ ìƒì„±"** ì„ íƒ
2. **ë³´ì•ˆ ê·¸ë£¹ ì´ë¦„**: `skn21-django-sg`
3. **ì„¤ëª…**: `Django app security group`

> [!CAUTION]
> **ì„œë¸Œë„·ì„ ì˜ëª» ì„ íƒí•˜ë©´ ì™¸ë¶€ì—ì„œ SSH ì ‘ì†ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤!**
> - Private ì„œë¸Œë„· = ë°ì´í„°ë² ì´ìŠ¤ìš© (ì™¸ë¶€ ì ‘ì† ì°¨ë‹¨)
> - Public ì„œë¸Œë„· = ì›¹ ì„œë²„ìš© (ì™¸ë¶€ ì ‘ì† ê°€ëŠ¥)

**ì¸ë°”ìš´ë“œ ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™** (ì²˜ìŒì—ëŠ” ê¸°ë³¸ê°’ ìœ ì§€, ë‚˜ì¤‘ì— ì¶”ê°€):
- SSH (22) - ë‚´ IPë§Œ í—ˆìš© (ìë™ ì„¤ì •ë¨)

#### 6ï¸âƒ£ ìŠ¤í† ë¦¬ì§€ êµ¬ì„±
- **í¬ê¸°**: 30 GiB (ê¸°ë³¸ê°’)
- **ë³¼ë¥¨ ìœ í˜•**: gp3 (ë²”ìš© SSD)

#### 7ï¸âƒ£ ê³ ê¸‰ ì„¸ë¶€ ì •ë³´
- ê¸°ë³¸ê°’ ì‚¬ìš© (ë³€ê²½ ë¶ˆí•„ìš”)

### Step 3: ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘

1. ìš°ì¸¡ **"ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘"** ë²„íŠ¼ í´ë¦­
2. "ì„±ê³µì ìœ¼ë¡œ ì‹œì‘í–ˆìŠµë‹ˆë‹¤" ë©”ì‹œì§€ í™•ì¸
3. **"ì¸ìŠ¤í„´ìŠ¤ ë³´ê¸°"** í´ë¦­

### Step 4: í¼ë¸”ë¦­ IP í™•ì¸

ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹œì‘ë˜ë©´ (ì•½ 1-2ë¶„ ì†Œìš”):
- **ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœ**: `ì‹¤í–‰ ì¤‘` (ì´ˆë¡ìƒ‰)
- **ìƒíƒœ ê²€ì‚¬**: `2/2 ê²€ì‚¬ í†µê³¼` ë˜ëŠ” `3/3 ê²€ì‚¬ í†µê³¼`
- **í¼ë¸”ë¦­ IPv4 ì£¼ì†Œ**: ì˜ˆ) `13.125.100.200` â† **ì´ IP ì£¼ì†Œë¥¼ ë³µì‚¬í•˜ì„¸ìš”!**

> [!TIP]
> í¼ë¸”ë¦­ IP ìë™ í• ë‹¹ì„ í™œì„±í™”í–ˆë‹¤ë©´ ìë™ìœ¼ë¡œ IPê°€ ë¶€ì—¬ë©ë‹ˆë‹¤. Elastic IPëŠ” ë¶ˆí•„ìš”í•©ë‹ˆë‹¤.

---

## ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •

ì›¹ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•´ ì¶”ê°€ í¬íŠ¸ë¥¼ ì—´ì–´ì•¼ í•©ë‹ˆë‹¤.

### Step 1: ë³´ì•ˆ ê·¸ë£¹ ì°¾ê¸°

1. EC2 ì½˜ì†” ì¢Œì¸¡ ë©”ë‰´ â†’ **"ë³´ì•ˆ ê·¸ë£¹"** í´ë¦­
2. `skn21-django-sg` ì°¾ì•„ì„œ ì²´í¬ë°•ìŠ¤ ì„ íƒ
3. í•˜ë‹¨ **"ì¸ë°”ìš´ë“œ ê·œì¹™"** íƒ­ í´ë¦­
4. **"ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘"** ë²„íŠ¼ í´ë¦­

### Step 2: ê·œì¹™ ì¶”ê°€

**"ê·œì¹™ ì¶”ê°€"** ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë‹¤ìŒ ê·œì¹™ë“¤ì„ ì¶”ê°€í•˜ì„¸ìš”:

| ìœ í˜•       | í”„ë¡œí† ì½œ | í¬íŠ¸ ë²”ìœ„ | ì†ŒìŠ¤      | ì„¤ëª… (ì˜ë¬¸ ê¶Œì¥)          |
| ---------- | -------- | --------- | --------- | ------------------------- |
| SSH        | TCP      | 22        | ë‚´ IP     | `SSH access`              |
| HTTP       | TCP      | 80        | 0.0.0.0/0 | `Web server (Nginx)`      |
| HTTPS      | TCP      | 443       | 0.0.0.0/0 | `SSL web server`          |
| Custom TCP | TCP      | 6333      | ë‚´ IP     | `Qdrant dashboard` (ì„ íƒ) |

> [!WARNING]
> AWS ë³´ì•ˆ ê·¸ë£¹ **ì„¤ëª… í•„ë“œëŠ” ì˜ë¬¸ë§Œ** ì§€ì›í•©ë‹ˆë‹¤. í•œê¸€ ì…ë ¥ ì‹œ "Invalid rule description" ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

> [!TIP]
> Qdrant í¬íŠ¸(6333)ëŠ” ê°œë°œ/í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œë§Œ ì—´ê³ , í”„ë¡œë•ì…˜ì—ì„œëŠ” ë‹«ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

### Step 3: ì €ì¥

- **"ê·œì¹™ ì €ì¥"** ë²„íŠ¼ í´ë¦­
- "ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤" ë©”ì‹œì§€ í™•ì¸

---

## SSH ì ‘ì†

### Windows (PowerShell ë˜ëŠ” Git Bash)

#### 1ï¸âƒ£ í‚¤ íŒŒì¼ ê¶Œí•œ ì„¤ì • (ë³´ì•ˆ ê°•í™”)

```powershell
# PowerShellì„ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰
# í‚¤ íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd C:\Users\<ì‚¬ìš©ìëª…>\.ssh

# ë‹¤ë¥¸ ì‚¬ìš©ì ê¶Œí•œ ì œê±°, ë³¸ì¸ë§Œ ì½ê¸° ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
icacls skn21-key.pem /inheritance:r
icacls skn21-key.pem /grant:r "$env:USERNAME`:R"

# ê¶Œí•œ í™•ì¸
icacls skn21-key.pem
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
skn21-key.pem <ì‚¬ìš©ìëª…>:(R)
```

> [!TIP]
> ê¶Œí•œ ì„¤ì • ì—†ì´ë„ SSH ì ‘ì†ì´ ê°€ëŠ¥í•  ìˆ˜ ìˆì§€ë§Œ, ë³´ì•ˆ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ë¥¼ ìœ„í•´ ì„¤ì •ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

#### 2ï¸âƒ£ SSH ì ‘ì†

```bash
# Git Bash ë˜ëŠ” PowerShellì—ì„œ
ssh -i C:\Users\<ì‚¬ìš©ìëª…>\.ssh\skn21-key.pem ubuntu@<EC2-í¼ë¸”ë¦­-IP>

# ì˜ˆì‹œ
ssh -i C:\Users\USER\.ssh\skn21-key.pem ubuntu@54.180.123.45
```

ì²˜ìŒ ì ‘ì† ì‹œ:
```
The authenticity of host '54.180.123.45' can't be established.
...
Are you sure you want to continue connecting (yes/no)?
```
â†’ **`yes`** ì…ë ¥ í›„ Enter

### Mac / Linux

#### 1ï¸âƒ£ í‚¤ íŒŒì¼ ê¶Œí•œ ì„¤ì •

```bash
chmod 400 ~/.ssh/skn21-key.pem
```

#### 2ï¸âƒ£ SSH ì ‘ì†

```bash
ssh -i ~/.ssh/skn21-key.pem ubuntu@<EC2-í¼ë¸”ë¦­-IP>

# ì˜ˆì‹œ
ssh -i ~/.ssh/skn21-key.pem ubuntu@54.180.123.45
```

### ì ‘ì† ì„±ê³µ í™•ì¸

ì ‘ì†ì— ì„±ê³µí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:

```
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-1048-aws x86_64)

...

ubuntu@ip-172-31-x-x:~$
```

> [!NOTE]
> í”„ë¡¬í”„íŠ¸ê°€ `ubuntu@ip-172-31-x-x:~$`ë¡œ ë°”ë€Œë©´ ì„±ê³µì…ë‹ˆë‹¤!

---

## ì„œë²„ ì´ˆê¸° ì„¤ì •

ì´ì œ EC2 ì„œë²„ì— ì ‘ì†í–ˆìœ¼ë‹ˆ, ì„œë²„ë¥¼ ì´ˆê¸° ì„¤ì •í•©ë‹ˆë‹¤.

### Step 1: í”„ë¡œì íŠ¸ ì½”ë“œ ì—…ë¡œë“œ

#### ë°©ë²• A: Gitìœ¼ë¡œ í´ë¡  (ì¶”ì²œ)

```bash
# GitHubì— ì½”ë“œê°€ ìˆëŠ” ê²½ìš°
cd ~
git clone https://github.com/<ì‚¬ìš©ìëª…>/SKN21-4th-4Team.git app
cd app
```

#### ë°©ë²• B: SCPë¡œ íŒŒì¼ ì „ì†¡

ë¡œì»¬ PCì—ì„œ (ìƒˆ í„°ë¯¸ë„ ì—´ì–´ì„œ):
```bash
# Windows (Git Bash)
scp -i C:\Users\USER\.ssh\skn21-key.pem -r C:\SKN21-4th-4Team ubuntu@54.180.123.45:~/app

# Mac/Linux
scp -i ~/.ssh/skn21-key.pem -r ~/SKN21-4th-4Team ubuntu@54.180.123.45:~/app
```

### Step 2: ì´ˆê¸° ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
# EC2 ì„œë²„ì—ì„œ ì‹¤í–‰
cd ~/app/deploy
chmod +x setup-ec2.sh

# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (Docker, ë°©í™”ë²½ ë“± ì„¤ì¹˜)
sudo ./setup-ec2.sh
```

**ì‹¤í–‰ ì¤‘ ì¶œë ¥**:
```
================================
EC2 ì´ˆê¸° ì„¤ì • ì‹œì‘
================================
[1/7] ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸ ì¤‘...
[2/7] í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì¤‘...
[3/7] Docker ì„¤ì¹˜ ì¤‘...
...
âœ“ EC2 ì´ˆê¸° ì„¤ì • ì™„ë£Œ!
```

### Step 3: ì¬ë¡œê·¸ì¸

Docker ê¶Œí•œ ì ìš©ì„ ìœ„í•´ ì¬ë¡œê·¸ì¸:

```bash
# í˜„ì¬ SSH ì„¸ì…˜ ì¢…ë£Œ
exit

# ë‹¤ì‹œ SSH ì ‘ì†
ssh -i ~/.ssh/skn21-key.pem ubuntu@54.180.123.45
```

### Step 4: Docker í™•ì¸

```bash
# sudo ì—†ì´ docker ëª…ë ¹ì–´ ì‹¤í–‰ ê°€ëŠ¥ í™•ì¸
docker --version
docker compose version
```

---

## ì½”ë“œ ë°°í¬

### Step 1: í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```bash
cd ~/app

# .env íŒŒì¼ ìƒì„±
cp deploy/.env.example .env

# .env íŒŒì¼ í¸ì§‘
vim .env
# ë˜ëŠ”
nano .env
```

**í•„ìˆ˜ ì„¤ì • í•­ëª©**:
```bash
DJANGO_SECRET_KEY=<ê°•ë ¥í•œ-ë¹„ë°€ë²ˆí˜¸-ìƒì„±>
DJANGO_ALLOWED_HOSTS=54.180.123.45,localhost,127.0.0.1
OPENAI_API_KEY=<ë³¸ì¸ì˜-OpenAI-API-í‚¤>
TAVILY_API_KEY=<ë³¸ì¸ì˜-Tavily-API-í‚¤>

# Database (RDS PostgreSQL) - íŒ€ì›ê³¼ ê³µìœ ëœ ì •ë³´ ì…ë ¥
DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=vmffpdlepdlxj1!
DB_HOST=skn21-django-db.cfo0sc4o2oej.ap-northeast-2.rds.amazonaws.com
DB_PORT=5432
```



> [!TIP]
> Django SECRET_KEY ìƒì„± ë°©ë²•:
> ```bash
> python3 -c "import secrets; print(secrets.token_urlsafe(50))"
> ```

ì €ì¥: 
- vim: `ESC` â†’ `:wq` â†’ `Enter`
- nano: `Ctrl+X` â†’ `Y` â†’ `Enter`

### Step 2: í™˜ê²½ë³€ìˆ˜ ê²€ì¦

```bash
cd ~/app/deploy
chmod +x validate-env.sh
./validate-env.sh
```

ì¶œë ¥ ì˜ˆì‹œ:
```
âœ“ DJANGO_SECRET_KEY: ì„¤ì •ë¨
âœ“ DJANGO_ALLOWED_HOSTS: 54.180.123.45,localhost
âœ“ OPENAI_API_KEY: ì„¤ì •ë¨ (sk-proj-ab...)
âš  TAVILY_API_KEY: ì„¤ì •ë˜ì§€ ì•ŠìŒ (ì„ íƒì‚¬í•­)
```

### Step 3: ë°°í¬ ì‹¤í–‰

```bash
chmod +x deploy.sh
./deploy.sh
```

**ì‹¤í–‰ ê³¼ì •**:
```
================================
ë°°í¬ ì‹œì‘
================================
[1/6] Git ìµœì‹  ì½”ë“œ ê°€ì ¸ì˜¤ê¸°...
[2/6] í™˜ê²½ë³€ìˆ˜ íŒŒì¼ í™•ì¸...
[3/6] ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì •ë¦¬...
[4/6] Docker ì´ë¯¸ì§€ ë¹Œë“œ...
[5/6] ì»¨í…Œì´ë„ˆ ì‹œì‘...
[6/6] ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸...
âœ“ ë°°í¬ ì™„ë£Œ!
```

### Step 4: ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” (ì²˜ìŒ ë°°í¬ ì‹œì—ë§Œ)

**RDS PostgreSQL ë§ˆì´ê·¸ë ˆì´ì…˜**:
```bash
# ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±
docker exec django_app python django_app/manage.py migrate

# ìŠˆí¼ìœ ì € ìƒì„± (ê´€ë¦¬ì ê³„ì •)
docker exec -it django_app python django_app/manage.py createsuperuser

# ì •ì  íŒŒì¼ ìˆ˜ì§‘
docker exec django_app python django_app/manage.py collectstatic --noinput
```

> [!NOTE]
> - ë§ˆì´ê·¸ë ˆì´ì…˜ì€ **ì²˜ìŒ ë°°í¬í•  ë•Œë§Œ** ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤
> - ì´í›„ ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹œì—ëŠ” ëª¨ë¸ ë³€ê²½ì´ ìˆì„ ë•Œë§Œ ë‹¤ì‹œ ì‹¤í–‰


---

## ì„œë¹„ìŠ¤ ì‹¤í–‰ í™•ì¸

### Step 1: ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

```bash
cd ~/app/deploy
docker compose ps
```

**ì •ìƒ ì¶œë ¥ ì˜ˆì‹œ**:
```
NAME         STATUS        PORTS
django_app   Up 30 seconds 0.0.0.0:8000->8000/tcp
nginx        Up 30 seconds 0.0.0.0:80->80/tcp, 0.0.0.0:443->443/tcp
qdrant       Up 30 seconds 0.0.0.0:6333->6333/tcp
```

### Step 2: ë¡œê·¸ í™•ì¸

```bash
# ì „ì²´ ë¡œê·¸
docker compose logs

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸ë§Œ ë³´ê¸°
docker compose logs django
docker compose logs nginx
docker compose logs qdrant

# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
docker compose logs -f
```

### Step 3: ì›¹ ë¸Œë¼ìš°ì €ë¡œ ì ‘ì† í…ŒìŠ¤íŠ¸

ë¡œì»¬ PC ë¸Œë¼ìš°ì €ì—ì„œ:

1. **Qdrant ëŒ€ì‹œë³´ë“œ**
   ```
   http://<EC2-í¼ë¸”ë¦­-IP>:6333/dashboard
   ì˜ˆ: http://54.180.123.45:6333/dashboard
   ```

2. **Django ì•±** (ì¤€ë¹„ë˜ë©´)
   ```
   http://<EC2-í¼ë¸”ë¦­-IP>
   ì˜ˆ: http://54.180.123.45
   ```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### âŒ SSH ì ‘ì† ì‹¤íŒ¨

**ë¬¸ì œ**: `Permission denied (publickey)`

**í•´ê²°**:
```bash
# í‚¤ íŒŒì¼ ê¶Œí•œ í™•ì¸
chmod 400 ~/.ssh/skn21-key.pem

# ì˜¬ë°”ë¥¸ ì‚¬ìš©ìëª… í™•ì¸ (ubuntu)
ssh -i ~/.ssh/skn21-key.pem ubuntu@<IP>
```

### âŒ Docker ë¹Œë“œ ì‹¤íŒ¨

**ë¬¸ì œ**: Docker ì´ë¯¸ì§€ ë¹Œë“œ ì¤‘ ì—ëŸ¬

**í•´ê²°**:
```bash
# Docker ë°ëª¬ ìƒíƒœ í™•ì¸
sudo systemctl status docker

# Docker ì¬ì‹œì‘
sudo systemctl restart docker

# ìºì‹œ ì—†ì´ ì¬ë¹Œë“œ
cd ~/app/deploy
docker compose build --no-cache
```

### âŒ í¬íŠ¸ ì ‘ì† ì•ˆ ë¨

**ë¬¸ì œ**: ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†ì´ ì•ˆ ë¨

**ì²´í¬ë¦¬ìŠ¤íŠ¸**:
1. ë³´ì•ˆ ê·¸ë£¹ì—ì„œ í•´ë‹¹ í¬íŠ¸ ì—´ì—ˆëŠ”ì§€ í™•ì¸
2. ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸: `docker compose ps`
3. ë°©í™”ë²½ í™•ì¸: `sudo ufw status`

### âŒ ì»¨í…Œì´ë„ˆê°€ ê³„ì† ì¬ì‹œì‘ë¨

**ë¬¸ì œ**: `STATUS`ê°€ `Restarting`

**í•´ê²°**:
```bash
# ë¡œê·¸ í™•ì¸í•˜ì—¬ ì›ì¸ íŒŒì•…
docker compose logs <ì„œë¹„ìŠ¤ëª…>

# .env íŒŒì¼ ì¬í™•ì¸
./deploy/validate-env.sh
```

---

## ìœ ìš©í•œ ëª…ë ¹ì–´

### Docker ê´€ë ¨

```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker compose ps

# ë¡œê·¸ ë³´ê¸°
docker compose logs -f [ì„œë¹„ìŠ¤ëª…]

# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker compose restart [ì„œë¹„ìŠ¤ëª…]

# ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker compose down

# ì „ì²´ ì¬ë°°í¬
./deploy/deploy.sh
```

### ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§

```bash
# CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
htop

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
df -h

# Docker ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats
```

### ì½”ë“œ ì—…ë°ì´íŠ¸

```bash
# Git pull í›„ ì¬ë°°í¬
cd ~/app
git pull
./deploy/deploy.sh
```

---

## ë‹¤ìŒ ë‹¨ê³„

- [ ] SSL/TLS ì¸ì¦ì„œ ì„¤ì • (HTTPS)
- [ ] ë„ë©”ì¸ ì—°ê²°
- [ ] ë¡œê·¸ ëª¨ë‹ˆí„°ë§ ì„¤ì •
- [ ] ë°±ì—… ì „ëµ ìˆ˜ë¦½
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

---

## ì°¸ê³  ìë£Œ

- [AWS EC2 ê³µì‹ ë¬¸ì„œ](https://docs.aws.amazon.com/ec2/)
- [Docker ê³µì‹ ë¬¸ì„œ](https://docs.docker.com/)
- [Ubuntu 22.04 ê°€ì´ë“œ](https://ubuntu.com/server/docs)
